@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix meds: <https://teamheka.github.io/meds-ontology#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<https://teamheka.github.io/meds-ontology> a owl:Ontology ;
    rdfs:label "MEDS Ontology"@en ;
    dcterms:abstract """The MEDS Ontology is an OWL ontology that formally encodes the
Medical Event Data Standard (MEDS) conceptual data model.
It provides a semantic representation of medical event data
to support interoperability, validation, and machine-readable
analysis across datasets."""@en ;
    dcterms:created "2025-12-04"^^xsd:date ;
    dcterms:creator "Alberto Marfoglia" ;
    dcterms:description """This ontology provides a semantic framework for representing
key components of the Medical Event Data Standard (MEDS),
including subjects, clinical measurements, code metadata,
dataset-level provenance, subject splits, and prediction labels.

The ontology is accompanied by SHACL shapes that constrain
and validate data according to the MEDS conceptual model,
enabling consistent data representation and quality control
across implementations."""@en ;
    dcterms:license <https://creativecommons.org/licenses/by/4.0/> ;
    dcterms:modified "2025-12-16"^^xsd:date ;
    dcterms:publisher "HeKa Team"@en ;
    dcterms:title "MEDS Ontology"@en ;
    owl:versionInfo "1.0.1" .

meds:additionalValueModalityColumn a owl:DatatypeProperty ;
    rdfs:label "additionalValueModalityColumn" ;
    rdfs:comment "Column containing additional value modality (image, waveform, etc.). OPTIONAL. One triple per column. Matches MEDS: additional_value_modality_columns." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:assignedSplit a owl:ObjectProperty ;
    rdfs:label "assignedSplit" ;
    rdfs:comment "Assign a subject to a split (train, tuning, held_out)." ;
    rdfs:domain meds:Subject ;
    rdfs:range meds:SubjectSplit .

meds:codeDescription a owl:DatatypeProperty ;
    rdfs:label "codeDescription" ;
    rdfs:comment "Human readable description of the code." ;
    rdfs:domain meds:Code ;
    rdfs:range xsd:string .

meds:codeModifierColumn a owl:DatatypeProperty ;
    rdfs:label "codeModifierColumn" ;
    rdfs:comment "Column used to modify/augment code values. OPTIONAL. One triple per column. Matches MEDS: code_modifier_columns." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:hasValueModality a owl:ObjectProperty ;
    rdfs:label "hasValueModality" ;
    rdfs:comment "Attach additional value modalities (image, waveform, etc.) to a Event." ;
    rdfs:domain meds:Event ;
    rdfs:range meds:ValueModality .

meds:heldOutSplit a meds:SubjectSplit ;
    rdfs:label "held_out"@en .

meds:otherExtensionColumn a owl:DatatypeProperty ;
    rdfs:label "otherExtensionColumn" ;
    rdfs:comment "Other dataset-specific extension column not covered elsewhere. OPTIONAL. One triple per column. Matches MEDS: other_extension_columns." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:parentCode a owl:ObjectProperty ;
    rdfs:label "parentCode" ;
    rdfs:comment "Ontological/aggregation parent relations between codes (maps to CodeMetadata.parent_codes)." ;
    rdfs:domain meds:Code ;
    rdfs:range meds:Code .

meds:rawSourceIdColumn a owl:DatatypeProperty ;
    rdfs:label "rawSourceIdColumn" ;
    rdfs:comment "Raw source ID column before mapping to subject IDs. OPTIONAL. One triple per column. Matches MEDS: raw_source_id_columns." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:siteIdColumn a owl:DatatypeProperty ;
    rdfs:label "siteIdColumn" ;
    rdfs:comment "Column representing a site identifier. OPTIONAL. One triple per column. Previously siteIdColumns." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:subjectIdColumn a owl:DatatypeProperty ;
    rdfs:label "subjectIdColumn" ;
    rdfs:comment "Column used as a subject identifier. REQUIRED. One triple per column. Previously subjectIdColumns." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:trainSplit a meds:SubjectSplit ;
    rdfs:label "train"@en .

meds:tuningSplit a meds:SubjectSplit ;
    rdfs:label "tuning"@en .

meds:ValueModality a owl:Class ;
    rdfs:label "ValueModality" ;
    rdfs:comment "Generic holder for additional value modalities (image path, waveform id, etc.). Instances may contain modality-specific properties." .

meds:booleanValue a owl:DatatypeProperty ;
    rdfs:label "booleanValue" ;
    rdfs:comment "Boolean label value (if applicable)." ;
    rdfs:domain meds:LabelSample ;
    rdfs:range xsd:boolean .

meds:categoricalValue a owl:DatatypeProperty ;
    rdfs:label "categoricalValue" ;
    rdfs:comment "Categorical label encoded as a string." ;
    rdfs:domain meds:LabelSample ;
    rdfs:range xsd:string .

meds:floatValue a owl:DatatypeProperty ;
    rdfs:label "floatValue" ;
    rdfs:comment "Float label value (continuous target)." ;
    rdfs:domain meds:LabelSample ;
    rdfs:range xsd:double .

meds:hasCode a owl:ObjectProperty ;
    rdfs:label "hasCode" ;
    rdfs:comment "Link from a Event to a Code metadata entry. If no Code metadata file exists, codeString on Event is used." ;
    rdfs:domain meds:Event ;
    rdfs:range meds:Code .

meds:integerValue a owl:DatatypeProperty ;
    rdfs:label "integerValue" ;
    rdfs:comment "Integer label value (e.g., ordinal labels)." ;
    rdfs:domain meds:LabelSample ;
    rdfs:range xsd:integer .

meds:medsVersion a owl:DatatypeProperty ;
    rdfs:label "medsVersion" ;
    rdfs:comment "Version of the MEDS schema used to generate the dataset. REQUIRED. Matches MEDS: meds_version." ;
    rdfs:domain meds:DatasetMetadata ;
    rdfs:range xsd:string .

meds:numericValue a owl:DatatypeProperty ;
    rdfs:label "numericValue" ;
    rdfs:comment "Numeric event value (optional in MEDS)." ;
    rdfs:domain meds:Event ;
    rdfs:range xsd:double .

meds:predictionTime a owl:DatatypeProperty ;
    rdfs:label "predictionTime" ;
    rdfs:comment "Inclusive endpoint of the data usable for predicting the label (required for LabelSample)." ;
    rdfs:domain meds:LabelSample ;
    rdfs:range xsd:dateTime .

meds:subjectId a owl:DatatypeProperty,
        owl:FunctionalProperty ;
    rdfs:comment "Unique identifier for a Subject; functional (= at most one value per Subject)." ;
    rdfs:domain meds:Subject ;
    rdfs:range xsd:string .

meds:textValue a owl:DatatypeProperty ;
    rdfs:label "textValue" ;
    rdfs:comment "Text event value (optional in MEDS)." ;
    rdfs:domain meds:Event ;
    rdfs:range xsd:string .

meds:time a owl:DatatypeProperty ;
    rdfs:label "time" ;
    rdfs:comment "Timestamp of the event. MEDS allows null for static events; modelled as 0..1 cardinality." ;
    rdfs:domain meds:Event ;
    rdfs:range xsd:dateTime .

meds:codeString a owl:DatatypeProperty,
        owl:FunctionalProperty ;
    rdfs:comment "Canonical textual code; functional for Code. Also present on Event when no Code metadata exists." ;
    rdfs:domain [ a owl:Class ;
            owl:unionOf ( meds:Code meds:Event ) ] ;
    rdfs:range xsd:string .

meds:hasSubject a owl:ObjectProperty ;
    rdfs:label "hasSubject" ;
    rdfs:comment "Links a Event or LabelSample to its Subject (maps to subject_id)." ;
    rdfs:domain meds:Event,
        meds:LabelSample ;
    rdfs:range meds:Subject .

meds:Subject a owl:Class ;
    rdfs:label "Subject" ;
    rdfs:comment "Primary entity for which care observations are recorded. Maps to MEDS subject_id (patient or admission-level subject)." ;
    rdfs:subClassOf [ a owl:Restriction ;
            owl:allValuesFrom meds:DatasetMetadata ;
            owl:onProperty prov:wasDerivedFrom ] ;
    owl:hasKey ( meds:subjectId ) .

meds:SubjectSplit a owl:Class ;
    rdfs:label "SubjectSplit" ;
    rdfs:comment "An assignment of a subject to a named split (train, tuning, held_out)." .

meds:Code a owl:Class ;
    rdfs:label "Code" ;
    rdfs:comment "Metadata/vocabulary entry describing a event code (code string, description, parent codes, external links)." ;
    rdfs:subClassOf [ a owl:Restriction ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:codeString ],
        [ a owl:Restriction ;
            owl:allValuesFrom meds:DatasetMetadata ;
            owl:onProperty prov:wasDerivedFrom ] ;
    owl:hasKey ( meds:codeString ) .

meds:Event a owl:Class ;
    rdfs:label "Event" ;
    rdfs:comment "A single observation/row in MEDS: (subject, time?, code, value modalities...). Time is nullable for static events." ;
    rdfs:subClassOf [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:textValue ],
        [ a owl:Restriction ;
            owl:allValuesFrom meds:DatasetMetadata ;
            owl:onProperty prov:wasDerivedFrom ],
        [ a owl:Restriction ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:hasSubject ],
        [ a owl:Restriction ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:hasCode ],
        [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:time ],
        [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:numericValue ] ;
    owl:disjointWith meds:LabelSample .

meds:LabelSample a owl:Class ;
    rdfs:label "LabelSample" ;
    rdfs:comment "A prediction sample row: subject, prediction_time, and one label value (boolean/integer/float/categorical)." ;
    rdfs:subClassOf [ a owl:Restriction ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:hasSubject ],
        [ a owl:Restriction ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:predictionTime ],
        [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:booleanValue ],
        [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:integerValue ],
        [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:floatValue ],
        [ a owl:Restriction ;
            owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:categoricalValue ],
        [ a owl:Restriction ;
            owl:allValuesFrom meds:DatasetMetadata ;
            owl:onProperty prov:wasDerivedFrom ] .

meds:DatasetMetadata a owl:Class ;
    rdfs:label "DatasetMetadata" ;
    rdfs:comment "High-level provenance and conversion metadata for a MEDS dataset." ;
    rdfs:subClassOf [ a owl:Restriction ;
            owl:allValuesFrom xsd:string ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty dcterms:title ],
        [ a owl:Restriction ;
            owl:allValuesFrom xsd:string ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty dcterms:created ],
        [ a owl:Restriction ;
            owl:allValuesFrom dcat:Distribution ;
            owl:onProperty dcat:distribution ],
        [ a owl:Restriction ;
            owl:allValuesFrom prov:Activity ;
            owl:onProperty prov:wasGeneratedBy ],
        [ a owl:Restriction ;
            owl:allValuesFrom rdfs:Resource ;
            owl:maxCardinality 1 ;
            owl:onProperty dcterms:hasVersion ],
        [ a owl:Restriction ;
            owl:allValuesFrom dcterms:LicenseDocument ;
            owl:maxCardinality 1 ;
            owl:onProperty dcterms:license ],
        [ a owl:Restriction ;
            owl:cardinality "1"^^xsd:nonNegativeInteger ;
            owl:onProperty meds:medsVersion ],
        dcat:Dataset,
        prov:Entity .

